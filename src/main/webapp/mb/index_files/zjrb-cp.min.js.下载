(function(root,factory){if(typeof define==="function"&&define.amd){define([],function(vuecallback){factory(function(api){root.CP=api;root.cloudplate=root.CP._core;if(window){window.CP=api;window.cloudplate=root.CP._core}root.CP._init();vuecallback&&vuecallback()})})}else{if(typeof exports==="object"){module.exports=function(vuecallback){factory(function(api){root.CP=api;root.cloudplate=root.CP._core;if(window){window.CP=api;window.cloudplate=root.CP._core}root.CP._init();vuecallback&&vuecallback();return api})}}else{factory(function(api){root.CP=api;root.cloudplate=root.CP._core;if(window){window.CP=api;window.cloudplate=root.CP._core}root.CP._init()})}}})(this,function(initcallback){var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _jsFilePath="https://open.8531.cn/js/";var Driver=function(readycallback){var drivers={web:{driver_params:{},preloadfiles:[],check:function(callback){if(Tools.browser()=="pc"){callback({client_code:"web",version:"1.0",detail:""})}},load:function(client_info,callback){alert("请在app端打开此链接，web端暂不支持")},init:function(options){},delegate:function(event,data){}},zjxw:{driver_params:{},preloadfiles:[_jsFilePath+"common/cp-zjxw-cloudplate.js"],check:function(callback){if(typeof zjxw!="undefined"){var version=zjxw.zjxw_js_getAppVersionCode();callback({client_code:"zjxw",version:version,detail:""})}},load:function(driver_params,callback){Request._loadResource(this.preloadfiles,function(){callback(driver_params)})},init:function(options){options.ready()},delegate:function(event,data){data=data?data:"";switch(event){case"show_login":zjxw.zjxw_js_login();break;case"is_login":var result=zjxw.zjxw_js_isUserRealLogin();var res_data={is_login:"0"};if(result===true||result===false||result==="true"||result==="false"){res_data.is_login=result?"1":"0";if(typeof result=="string"){res_data.is_login="true"?"1":"0"}else{if(typeof result=="boolean"){res_data.is_login=result===true?"1":"0"}}cloudplate.trigger("is_login",JSON.stringify(res_data))}break;case"get_unique_id":zjxw.zjxw_js_getRealSessionId();break;case"get_account_id":zjxw.zjxw_js_getRealAccountId();break;case"get_client_info":var version=zjxw.zjxw_js_getAppVersionCode();cloudplate.trigger("get_client_info",JSON.stringify({client_code:"zjxw",version:version,detail:""}));break;case"get_device_info":zjxw.zjxw_js_getDeviceId();break;case"reset":break;case"get_css_mode":zjxw.zjxw_js_isAppOpenNightTheme();break;case"show_share":if(typeof data=="string"){try{data=JSON.parse(data)}catch(e){}}var shareTitle=data.title?data.title:"",shareSummary=data.shareSummary?data.shareSummary:"",shareLink=data.link?data.link:"",shareImage=data.imgUrl?data.imgUrl:"",uid=data.id?data.id:"",uidType=data.type?data.type:"";zjxw.zjxw_js_reweet(shareTitle,shareSummary,shareLink,shareImage,uid,uidType);break;case"get_location_info":zjxw.zjxw_js_getLocationInfo();break;case"get_customer_info":var customer_info={account_id:"",username:"",head_img:"",nick_name:"",score:""};function customerInfo(){if(customer_info&&customer_info.account_id&&customer_info.username){Core.trigger("get_customer_info",JSON.stringify(customer_info))}}Core.register("get_account_id",function(data){if(data&&data.account_id){customer_info.account_id=data.account_id}customerInfo()},true);Core.register("get_customer_name",function(data){if(data&&data.name){customer_info.username=data.name}customerInfo()},true);zjxw.zjxw_js_getRealAccountId();zjxw.zjxw_js_getRealLoginName();break;case"get_download_info":break;case"get_ip":break;case"get_image":zjxw.zjxw_js_selectImage();break;case"get_voice":break;case"start_voice":cloudplate.trigger("start_voice",JSON.stringify(data));zjxw.zjxw_js_startRecord();break;case"file_upload":zjxw.zjxw_js_fileUpload(data.serviceurl,data.localfile,data.filename,data.inputname);break;case"stop_voice":break;case"get_video":break;case"get_scan_qr":break;case"search_beacons":break;case"shake":break;case"close":zjxw.zjxw_js_close();break;case"set_data":zjxw.zjxw_js_setKeyValue(data.storage,data.key,data.value);cloudplate.trigger("set_data",JSON.stringify({success:true}));break;case"get_data":zjxw.zjxw_js_getKeyValue(data.storage,data.key);break;case"set_share":var shareTitle=data.title?data.title:"",shareSummary=data.shareSummary?data.shareSummary:"",shareLink=data.link?data.link:"",shareImage=data.imgUrl?data.imgUrl:"",shareUrlScheme=data.shareUrlScheme?data.shareUrlScheme:"";zjxw.zjxw_js_updateShareInfo(shareTitle,shareSummary,shareLink,shareImage,shareUrlScheme);break;case"play_voice":break;case"pause_play_voice":break;case"stop_play_voice":break;case"url_redirect":var flag=false;var timer=setInterval(function(){if(!flag){flag=true;window.location.href=data.url;clearInterval(timer)}},200);break;case"bindmobile":if(zjxw&&zjxw.zjxw_js_bindmobile){zjxw.zjxw_js_bindmobile()}break;case"is_bindmobile":if(zjxw&&zjxw.zjxw_js_isUserBindMobile){zjxw.zjxw_js_isUserBindMobile()
}break;default:break}}},xsb:{driver_params:{},preloadfiles:[],check:function(callback){if(typeof xsb!="undefined"){callback({client_code:"zjxw",version:111,detail:""})}},load:function(client_info,callback){},init:function(options){}},h24:{driver_params:{},preloadfiles:[],check:function(callback){if(typeof h24!="undefined"){Core.register("get_client_info",function(data){callback({client_code:data.client_code,version:data.version,detail:data.detail})},true);h24.zjrb_cp_get_client_info()}},load:function(driver_params,callback){callback(driver_params)},init:function(options){options.ready()},delegate:function(event,data){data=data?data:"";switch(event){case"show_login":h24.zjrb_cp_show_login();break;case"is_login":h24.zjrb_cp_is_login();break;case"get_unique_id":h24.zjrb_cp_get_unique_id();break;case"get_account_id":h24.zjrb_cp_get_account_id();break;case"get_client_info":h24.zjrb_cp_get_client_info();break;case"get_device_info":h24.zjrb_cp_get_device_info();break;case"reset":h24.zjxw_js_getRealAccountId();break;case"get_css_mode":h24.zjrb_cp_get_css_mode();break;case"show_share":var shareTitle=data.title?data.title:"",shareSummary=data.shareSummary?data.shareSummary:"",shareLink=data.link?data.link:"",shareImage=data.imgUrl?data.imgUrl:"",uid=data.id?data.id:"",uidType=data.type?data.type:"";h24.zjrb_cp_show_share(data);break;case"get_location_info":h24.zjrb_cp_get_location_info();break;case"get_customer_info":h24.zjrb_cp_get_customer_info();break;case"get_download_info":h24.zjrb_cp_get_download_info();break;case"get_ip":h24.zjrb_cp_get_ip();break;case"get_image":h24.zjrb_cp_get_image(JSON.stringify(data));break;case"get_voice":h24.zjrb_cp_get_voice(JSON.stringify(data));break;case"start_voice":h24.zjrb_cp_start_voice(JSON.stringify(data));break;case"file_upload":break;case"stop_voice":h24.zjrb_cp_stop_voice(JSON.stringify(data));break;case"get_video":h24.zjrb_cp_get_video(JSON.stringify(data));break;case"get_scan_qr":break;case"search_beacons":break;case"shake":break;case"close":break;case"set_data":if(typeof data!="string"){data=JSON.stringify(data)}h24.zjrb_cp_setdata(data);break;case"get_data":if(typeof data!="string"){data=JSON.stringify(data)}h24.zjrb_cp_getdata(data);break;case"set_share":h24.zjrb_cp_setshareinfo(JSON.stringify(data));break;case"play_voice":break;case"pause_play_voice":break;case"stop_play_voice":break;case"url_redirect":window.location.href=data.url;break;case"bindmobile":break;case"is_bindmobile":break;default:break}}},wx:{driver_params:{},preloadfiles:["https://res.wx.qq.com/open/js/jweixin-1.2.0.js"],check:function(callback){if(Tools.browser(true)=="wx"){console&&console.log("微信版本暂不可使用")}},load:function(driver_params,callback){Request._loadResource(this.preloadfiles,function(){callback(driver_params)})},init:function(options){var params={"wx_appid":options.wx_option.appid,"method":options.wx_option.method,"url":encodeURIComponent(options.wx_option.redirect),"yun_callback":"CP._jsonpCallback"};var driver_var=this;driver_var["_options"]=options.wx_option;Core.register("sys_jsonp",function(data){if(data&&data.code&&data.code!=0||!wx||!wx.config){Tools.writelog("api requist error",data);return}var data=data.msg;wx&&wx.config({debug:options.debug,appId:data.appId,timestamp:data.timestamp,nonceStr:data.nonceStr,signature:data.signature,jsApiList:options.wx_option.jsApiList});wx&&wx.ready(function(){options.ready()});wx&&wx.error(function(res){if(this.debug){alert(res.errMsg)}})},true);Tools.ajax({url:"https://open.8531.cn/home/wx/index",type:"GET",data:params,dataType:"jsonp",success:function(){},fail:function(){}})},delegate:function(event,data){var driver_temp=this;data=data?data:"";switch(event){case"show_login":break;case"is_login":break;case"get_unique_id":break;case"get_account_id":break;case"get_client_info":break;case"get_device_info":break;case"reset":break;case"get_css_mode":break;case"show_share":break;case"get_location_info":wx&&wx.getLocation({type:"wgs84",success:function(res){var result={};result["lat"]=res.latitude;result["lon"]=res.longitude;result["radius"]="";result["city"]="";result["addr"]="";result["speed"]=res.speed;result["accuracy"]=res.accuracy;cloudplate.trigger("address_change",result)}});break;case"get_customer_info":break;case"get_download_info":break;case"get_ip":break;case"get_image":wx&&wx.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(res){Tools.writelog("get_image res",res);var result={address:res.localIds,id:data.id,sizeType:"original",sourceType:res.sourceType,count:1,dataType:"addr",data:[]};cloudplate.trigger("get_image",result)},fail:function(res){Tools.writelog("chooseImage-fail",res);alert(JSON.stringify(res))}});break;case"get_voice":break;case"start_voice":wx&&wx.onVoiceRecordEnd({complete:function(res){Tools.writelog("onVoiceRecordEnd",res);var result={id:data.id,address:res.localId};cloudplate.trigger("stop_voice",result)}});var result={id:data.id,address:"",info:""};Tools.writelog("startRecord ");
wx&&wx.startRecord({success:function(){cloudplate.trigger("start_voice",JSON.stringify(data))},cancel:function(res){result.info=res;cloudplate.trigger("stop_voice",res);Tools.writelog("wx startRecord cancel")}});break;case"file_upload":var result={requestcode:200,"return":{},info:""};var upload_urls=[];if(typeof(data.localfile)=="array"){upload_urls=data.localfile}else{if(typeof(data.localfile)=="string"){upload_urls=[data.localfile]}}Tools.writelog("file_upload params",data);if(data.type){if(data.type=="voice"){wx&&wx.uploadVoice({localId:upload_urls.toString(),isShowProgressTips:1,success:function(res){Tools.writelog("data type",res);res.wx_appid=driver_temp._options.appid;Tools.writelog("Tools data type",res);Tools.ajax({url:data.serviceurl,type:"post",data:res,dataType:"json",success:function(data){Tools.writelog("Tools data type",data);result.requestcode=200,result.data=data,cloudplate.trigger("file_upload",result)},error:function(xhr,errorType,error){Tools.writelog("Tools data type error",data);result.requestcode=400;result.data=error;cloudplate.trigger("file_upload",result)}})}})}else{if(data.type=="image"){wx&&wx.uploadImage({localId:upload_urls.toString(),isShowProgressTips:1,success:function(res){res.wx_appid=driver_temp._options.appid;Tools.ajax({url:data.serviceurl,type:"post",data:res,dataType:"json",success:function(data){result.requestcode=200;result.data=data;cloudplate.trigger("file_upload",result)},error:function(data){result.requestcode=400;result.data=data;cloudplate.trigger("file_upload",result)}})},fail:function(res){result.requestcode=401,result.data=res,cloudplate.trigger("file_upload",result)}})}else{Tools.ajax({url:data.serviceurl,type:"post",data:data,dataType:"json",success:function(data){result.requestcode=200,result.data=data,cloudplate.trigger("file_upload",result)},error:function(xhr,errorType,error){result.requestcode=400;result.data=error;cloudplate.trigger("file_upload",result)}})}}}break;case"stop_voice":wx&&wx.stopRecord({success:function(res){var result={id:data.id,address:res.localId};Core.trigger("stop_voice",result)},fail:function(res){Tools.writelog("wx stopRecord fail",res)}});break;case"get_video":break;case"get_scan_qr":wx&&wx.scanQRCode({desc:"scanQRCode desc",needResult:0,scanType:["qrCode","barCode"],success:function(res){},error:function(res){if(res.errMsg.indexOf("function_not_exist")>0){alert("版本过低请升级")}}});break;case"search_beacons":break;case"shake":break;case"close":wx&&wx.closeWindow();break;case"set_data":break;case"get_data":break;case"set_share":var result={"result":"success","shareTo":data.shareTo,"allow_alert":"0",};data["shareTo"]=data.shareTo?data.shareTo:"Timeline";if(data.shareTo=="Timeline"){wx&&wx.onMenuShareTimeline({title:data.title,link:data.link,imgUrl:data.imgUrl,success:function(){cloudplate.trigger("set_share",JSON.stringify(result))},cancel:function(){result.result="fail";cloudplate.trigger("set_share",JSON.stringify(result))}})}else{if(data.shareTo=="AppMessage"){wx&&wx.onMenuShareAppMessage({title:data.title,desc:data.shareSummary,link:data.link,imgUrl:data.imgUrl,type:data.datatype,dataUrl:data.dataUrl,success:function(){cloudplate.trigger("set_share",JSON.stringify(result))},cancel:function(){result.result="fail";cloudplate.trigger("set_share",JSON.stringify(result))}})}else{if(data.shareTo=="ShareQQ"){wx&&wx.onMenuShareQQ({title:data.title,desc:data.shareSummary,link:data.link,imgUrl:data.imgUrl,success:function(){cloudplate.trigger("set_share",JSON.stringify(result))},cancel:function(){result.result="fail";cloudplate.trigger("set_share",JSON.stringify(result))}})}else{if(data.shareTo=="WeiBo"){wx&&wx.onMenuShareWeibo({title:data.title,desc:data.shareSummary,link:data.link,imgUrl:data.imgUrl,success:function(){cloudplate.trigger("set_share",JSON.stringify(result))},cancel:function(){result.result="fail";cloudplate.trigger("set_share",JSON.stringify(result))}})}else{if(data.shareTo=="QQZone"){wx&&wx.onMenuShareQZone({title:data.title,desc:data.shareSummary,link:data.link,imgUrl:data.imgUrl,success:function(){cloudplate.trigger("set_share",JSON.stringify(result))},cancel:function(){result.result="fail";cloudplate.trigger("set_share",JSON.stringify(result))}})}}}}}break;case"play_voice":var ele_id="";if(data["ele_id"]){ele_id=data["ele_id"]}if(typeof(data.address)=="string"&&/^weixin:\/\/resourceid$/gi.test(data.address)){wx&&wx.playVoice({localId:data.address});return true}if(!typeof(data.address)=="string"||!/^(http|https):\/\/$/gi.test(data.address)){return false}if(!data["ele_id"]){ele_id=Tools.createAudioElement()}var audio=document.getElementById(ele_id);audio.src=data["address"];audio.play();if(data["on_play_end"]!=undefined){var is_playFinish=setInterval(function(){if(audio.ended){data["on_play_end"]({"ele_id":ele_id});window.clearInterval(is_playFinish)}},10)}return ele_id;break;case"pause_play_voice":wx&&wx.pauseVoice({localId:data.address});break;case"stop_play_voice":wx&&wx.stopVoice({localId:data.address});break;case"url_redirect":window.location.href=data.url;
break;case"bindmobile":break;case"is_bindmobile":break;default:break}}},};var loadDriver=function(client_info,readycallback){var index=client_info.client_code;if(!drivers[index]){return false}drivers[index].load(client_info,function(params){drivers[index].driver_params=params?params:{};readycallback(drivers[index])})};var getDriver=function(readycallback){if(drivers){var is_loaded=false;for(var index in drivers){drivers[index].check(function(client_info){if(is_loaded){return}is_loaded=true;loadDriver(client_info,readycallback)})}return}};getDriver(readycallback)};var Request={_requestQueue:[],_resourcePool:{},_getStyle:function(src,func){var cssstyle=document.createElement("link");cssstyle.async="async";cssstyle.href=src;cssstyle.rel="stylesheet";cssstyle.type="text/css";cssstyle.charset="UTF-8";if(func){cssstyle.onload=func}document.head.appendChild(cssstyle)},_getScript:function(src,func){var script=document.createElement("script");script.async="async";script.src=src;script.charset="UTF-8";if(func){script.onload=func}document.body.appendChild(script)},_checkRequestQueue:function(resources){for(var index in this._requestQueue){var flag=true,current=false;if(!this._requestQueue[index]){continue}if(resources===this._requestQueue[index].resources){current=true}for(var k in this._requestQueue[index].resources){if(this._resourcePool.hasOwnProperty(this._requestQueue[index].resources[k])&&this._resourcePool[this._requestQueue[index].resources[k]]!==2){flag=false}}if(flag){var done=this._requestQueue[index].callback;this._requestQueue[index]=null;setTimeout(function(){done()});if(current){return true}}}return false},_loadResourcePool:function(){var request=this;for(var index in this._resourcePool){if(!this._resourcePool[index]){var ext_index=index.lastIndexOf(".");var ext=index.substr(ext_index+1);if(ext==="js"||ext==="JS"){this._resourcePool[index]=1;this._getScript(index,function(){request._resourcePool[index]=2;request._checkRequestQueue()})}else{if(ext==="css"||ext==="CSS"){this._getStyle(index);this._resourcePool[index]=2}}}}},_loadResource:function(resources,callback){var request=this;var item={resources:resources,callback:function(){typeof callback=="function"&&callback()}};request._requestQueue.push(item);for(var index in resources){if(!request._resourcePool.hasOwnProperty(resources[index])){request._resourcePool[resources[index]]=0}}if(request._checkRequestQueue(resources)){return true}request._loadResourcePool()},loadContext:function(requires,callback){var request=this;var ok=true;var checkpool=function(){var flag=true;for(var i in request._resourcePool){if(!request._resourcePool[i]||request._resourcePool[i]!==2){flag=flag&&false}}if(flag){callback()}};if(!requires||requires==={}){callback()}for(var index in requires){var check_array=index.split(".");if(eval("typeof "+check_array[0]+' == "undefined";')||check_array[1]&&eval("typeof "+index+' == "undefined";')){ok=false;this._loadResource(requires[index],checkpool)}}if(ok){callback()}}};var Tools={ajax:function(){var _options={url:null,type:"GET",data:null,dataType:"text",jsonp:"callback",jsonpCallback:"jsonpCallback",async:true,cache:true,timeout:null,contentType:"application/x-www-form-urlencoded",success:null,fail:null};var _param=function _param(data){var str="";if(!data||_empty(data)){return str}if(data instanceof FormData){return data}for(var key in data){str+=key+"="+data[key]+"&"}str=str.slice(0,-1);return str};var _empty=function _empty(obj){for(var key in obj){return false}return true};var _extend=function _extend(target,options){if((typeof target==="undefined"?"undefined":_typeof(target))!=="object"||(typeof options==="undefined"?"undefined":_typeof(options))!=="object"){return}var copy,clone,name;for(name in options){if(options.hasOwnProperty(name)&&!target.hasOwnProperty(name)){target[name]=options[name]}}return target};var parseJSON=function parseJSON(text){if(typeof text!=="string"){return}if(JSON&&JSON.parse){return JSON.parse(text)}return new Function("return "+text)()};function _sendJsonpRequest(url,callbackName,succCallback){var script=document.createElement("script");script.type="text/javascript";script.src=url;document.body.appendChild(script);window[callbackName]=window[callbackName]||succCallback}return function(options){if(!options||!options.url){throw"参数错误！"}options.type=options.type.toUpperCase();_extend(options,_options);var search="";var param=_param(options.data);if(options.type==="GET"&&param){search=(options.url.indexOf("?")>-1?"&":"?")+param;if(!options.cache){search+="&radom="+Math.random()}param=null}if(options.dataType==="jsonp"){options.url=options.url+search;var jsonpUrl=options.url.indexOf("?")>-1?options.url:options.url+"?"+options.jsonp+"="+options.jsonpCallback;_sendJsonpRequest(jsonpUrl,options.jsonpCallback,options.success);return}var xhr=new (window.XMLHttpRequest||ActiveXObject)("Microsoft.XMLHTTP");xhr.open(options.type,options.url+search,options.async);xhr.onreadystatechange=function(){if(xhr.readyState==4){if(xhr.status>=200&&xhr.status<300||xhr.status==304){var text=xhr.responseText;
if(options.dataType=="json"){text=parseJSON(text)}if(typeof options.success==="function"){options.success(text,xhr.status)}}else{if(typeof options.fail==="function"){options.fail("获取失败",500)}}}};if(options.contentType!="multipart/form-data"){xhr.setRequestHeader("content-type",options.contentType)}xhr.send(param);if(typeof options.timeout==="number"){if(xhr.timeout){xhr.timeout=options.timeout}else{setTimeout(function(){xhr.abort()},options.timeout)}}}}(),random:function(){if(Math&&Math.round){return Math.round(Math.random()*100000000000)+(new Date()).valueOf()}return false},sleep:function(delay,extFun,callback){extFun=extFun?extFun:function(){return false};callback=callback?callback:function(){};var start=(new Date()).getTime();while(((new Date()).getTime()-start<delay)&&!extFun()){continue}callback()},contains:function(arr,obj){var i=arr.length;while(i--){if(arr[i]===obj){return true}}return false},writelog:function(key,$data){$data=$data?$data:"";var date="";if(typeof Date=="function"){function CurentTime(){var now=new Date();var year=now.getFullYear();var month=now.getMonth()+1;var day=now.getDate();var hh=now.getHours();var mm=now.getMinutes();var ss=now.getSeconds();var clock=year+"-";if(month<10){clock+="0"}clock+=month+"-";if(day<10){clock+="0"}clock+=day+" ";if(hh<10){clock+="0"}clock+=hh+":";if(mm<10){clock+="0"}clock+=mm+":";if(ss<10){clock+="0"}clock+=ss;return(clock)}date=CurentTime()}if(CP&&CP._options&&CP._options.debug){if(console&&console.log){console.log(date+" "+key,$data)}else{var p=document.createElement("p");var content="";if((typeof $data=="string")&&$data.constructor==String||typeof $data=="boolean"){content=$data}else{content=JSON.stringify($data)}p.innerText=date+" "+key+" : "+content;document.body.appendChild(p)}}else{}},browser:function(detail){if(!navigator||!navigator.userAgent){return""}var sUserAgent=navigator.userAgent.toLowerCase();var bIsIpad=sUserAgent.match(/ipad/i)=="ipad";var bIsIphoneOs=sUserAgent.match(/iphone os/i)=="iphone os";var bIsMidp=sUserAgent.match(/midp/i)=="midp";var bIsUc7=sUserAgent.match(/rv:1.2.3.4/i)=="rv:1.2.3.4";var bIsUc=sUserAgent.match(/ucweb/i)=="ucweb";var bIsAndroid=sUserAgent.match(/android/i)=="android";var bIsCE=sUserAgent.match(/windows ce/i)=="windows ce";var bIsWM=sUserAgent.match(/windows mobile/i)=="windows mobile";var bIswx=sUserAgent.match(/MicroMessenger/i)=="micromessenger";if(detail){if(bIswx){return"wx"}else{if(bIsIpad){return"ipad"}else{if(bIsIphoneOs){return"iphone os"}else{if(bIsMidp){return"midp"}else{if(bIsUc7){return"UC7"}else{if(bIsUc){return"ucweb"}else{if(bIsAndroid){return"android"}else{if(bIsCE){return"windows ce"}else{if(bIsWM){return"windows mobile"}}}}}}}}}}if(bIsIpad||bIsIphoneOs||bIsMidp||bIsUc7||bIsUc||bIsAndroid||bIsCE||bIsWM||bIswx){return"phone"}else{return"pc"}},createAudioElement:function(option){var audio=document.createElement("audio");audio.id="audio_"+this.random()+"_"+new Date().getTime();audio.src="";audio.style="width:0px;height:0px;border:none;margin:0px;padding:0px;";if(option&&option.control){audio.control=option.control}if(option&&option.style){audio.style=option.style}document.body.appendChild(audio);return audio.id}};var Core={synkeys:{},events:{sys_is_init:{test:function(data){Tools.writelog("sys_is_init 事件调用成功",data)}},sys_jsonp:{test:function(data){Tools.writelog("sys_jsonp 事件调用成功",data)}},is_login:{test:function(data){Tools.writelog("is_login 事件调用成功",data)}},get_unique_id:{test:function(data){Tools.writelog("get_unique_id 事件调用成功",data)}},get_account_id:{test:function(data){Tools.writelog("get_account_id 事件调用成功",data)}},get_client_info:{test:function(data){Tools.writelog("get_client_info 事件调用成功",data)}},get_device_info:{test:function(data){Tools.writelog("get_device_info 事件调用成功",data)}},reset:{test:function(data){Tools.writelog("reset 事件调用成功",data)}},mode_change:{test:function(data){Tools.writelog("mode_change 事件调用成功",data)}},get_share_result:{test:function(data){Tools.writelog("get_share_result 事件调用成功",data)}},address_change:{test:function(data){Tools.writelog("address_change 事件调用成功",data)}},get_customer_info:{test:function(data){Tools.writelog("get_customer_info 事件调用成功",data)}},get_download_info:{test:function(data){Tools.writelog("get_download_info 事件调用成功",data)}},get_ip:{test:function(data){Tools.writelog("get_ip 事件调用成功",data)}},get_image:{test:function(data){Tools.writelog("get_image 事件调用成功",data)}},get_voice:{test:function(data){Tools.writelog("get_voice 事件调用成功",data)}},start_voice:{test:function(data){Tools.writelog("start_voice 事件调用成功",data)}},cancel_voice:{test:function(data){Tools.writelog("cancel_voice 事件调用成功",data)}},file_upload:{test:function(data){Tools.writelog("file_upload 事件调用成功",data)}},stop_voice:{test:function(data){Tools.writelog("stop_voice 事件调用成功",data)}},auto_stop_voice:{test:function(data){Tools.writelog("auto_stop_voice 事件调用成功",data)}},get_video:{test:function(data){Tools.writelog("get_video 事件调用成功",data)}},shake:{test:function(data){Tools.writelog("shake 事件调用成功",data)
}},close:{test:function(data){Tools.writelog("close 事件调用成功",data)}},set_data:{test:function(data){Tools.writelog("set_data 事件调用成功",data)}},get_data:{test:function(data){Tools.writelog("get_data 事件调用成功",data)}},set_share:{test:function(data){Tools.writelog("set_share 事件调用成功",data)}},play_voice:{test:function(data){Tools.writelog("play_voice 事件调用成功",data)}},pause_play_voice:{test:function(data){Tools.writelog("pause_play_voice 事件调用成功",data)}},stop_play_voice:{test:function(data){Tools.writelog("stop_play_voice 事件调用成功",data)}},get_customer_name:{test:function(data){Tools.writelog("get_customer_name 事件调用成功",data)}},bindmobile:{test:function(data){Tools.writelog("bindmobile 事件调用成功",data)}},is_bindmobile:{test:function(data){Tools.writelog("is_bindmobile 事件调用成功",data)}}},synCheck:function(key){},register:function(event,callback,once,exclusive){once=once===false?"":"_once";exclusive=exclusive?"_exclusive":"";if(!(Core.events[event]&&Core.events[event])){return false}var key=Tools.random()+once+exclusive;Core.events[event][key]=callback;return key},trigger:function(event,json_data,callback,event_unique_key){if(!(Core.events&&Core.events[event]&&Core.events[event]!=={})){return false}try{var data=JSON.parse(json_data)}catch(e){var data=json_data}event_unique_key=event_unique_key?event_unique_key:"";try{for(var index in Core.events[event]){if(typeof Core.events[event][index]!="function"){continue}if((event_unique_key&&event_unique_key==index)||(!event_unique_key&&!index.indexOf("_exclusive")!=-1)){var callback_handle=Core.events[event][index];var result=callback_handle(data);if(this.synkeys&&this.synkeys.hasOwnProperty(index)){this.synkeys[index]=true}if(typeof callback=="function"){callback(result,data)}if(index&&index.indexOf("_once")!=-1){Core.events[event][index]=null}}}}catch(e){Tools.writelog("Error name:",e.name);Tools.writelog("Error ",e.message);Tools.writelog("Error detail",e)}}};var CallService=function(initcallback){var default_options={is_ready:false,is_ready_done:false,debug:false,wx_option:{},ready:null,shake:function(){},close:function(){}};var necessaryObject={"JSON.stringify":[_jsFilePath+"lib/json_parse_state.min.js",_jsFilePath+"lib/json_parse.min.js",_jsFilePath+"lib/json2.min.js"],"Math.min":[_jsFilePath+"lib/math.min.js"]};try{var apis={_params:{},_options:{},_driver:{delegate:function(key,data){if(!apis._params.count){apis._params["count"]=1}if(apis&&apis._options&&!apis._options.is_ready_done&&(apis._params.count&&apis._params.count<10)){setTimeout(function(){apis._params.count++;CP&&CP._driver&&CP._driver.delegate(key,data)},200)}},init:function(){}},_core:Core,_request:Request,_jsonpCallback:function(data){Core.trigger("sys_jsonp",data)},_init:function(){var api=this;Request.loadContext(necessaryObject,function(){Core.register("sys_is_init",api._ready,true);Driver(function(driver){api._driver=driver;if(api._options.ready&&typeof(api._options.ready)=="function"&&api._options&&!api._options.is_ready){Core.trigger("sys_is_init","",function(){api._options.is_ready_done=true});api._options.is_ready=true}})})},_ready:function(data){if(!apis._driver){return}if(apis._options.debug){Request._loadResource([_jsFilePath+"vconsole.min.js"],function(){var vConsole=new VConsole();apis._driver.init(apis._options);setTimeout(function(){Tools.writelog("window",window.location.href)},3000)})}else{apis._driver.init(apis._options)}},tools:Tools,ready:function(options){for(var index in default_options){if(options.hasOwnProperty(index)){this._options[index]=options[index]}else{this._options[index]=default_options[index]}}if(this._driver&&!this._options.is_ready){Core.trigger("sys_is_init");this._options.is_ready=true}},get_unique_id:function(callback,once,data){this._core.register("get_unique_id",callback,once);this._driver.delegate("get_unique_id",data)},get_account_id:function(callback,once,data){this._core.register("get_account_id",callback,once);this._driver.delegate("get_account_id",data)},get_client_info:function(callback,once,data){var client_info={client_code:"",version:"",detail:""};this._core.register("get_client_info",callback,once);this._driver.delegate("get_client_info",data)},get_device_info:function(callback,once,data){this._core.register("get_device_info",callback,once);this._driver.delegate("get_device_info",data)},is_login:function(callback,once,data){this._core.register("is_login",callback,once);this._driver.delegate("is_login",data)},show_login:function(callback,once,data){this._core.register("reset",callback,once);this._driver.delegate("show_login",data)},get_css_mode:function(callback,once,data){this._core.register("mode_change",callback,once);this._driver.delegate("get_css_mode",data)},show_share:function(callback,once,data){this._core.register("get_share_result",callback,once);this._driver.delegate("show_share",data)},get_location_info:function(callback,once,data){this._core.register("address_change",callback,once);this._driver.delegate("get_location_info",data)},get_customer_info:function(callback,once,data){this._core.register("get_customer_info",callback,once);
this._driver.delegate("get_customer_info",data)},get_download_info:function(callback,once,data){this._core.register("get_download_info",callback,once);this._driver.delegate("get_download_info",data)},get_ip:function(callback,once,data){this._core.register("get_ip",callback,once);this._driver.delegate("get_ip",data)},get_image:function(callback,once,data){this._core.register("get_image",callback,once);this._driver.delegate("get_image",data)},get_voice:function(callback,once,data){this._core.register("get_voice",callback,once);this._driver.delegate("get_voice",data)},start_voice:function(callback,cancelcallback,stopcallback,once,data){this._core.register("start_voice",callback,once);this._core.register("cancel_voice",cancelcallback,once);var stop_key=this._core.register("stop_voice",stopcallback,once);var apis_temp=this;if(data&&data.maxtime){this._params.setTimeout_start_voice=setTimeout(function(){this._driver.delegate("stop_voice",data)},data.maxtime)}this._driver.delegate("start_voice",data)},stop_voice:function(callback,once,data){this._core.register("stop_voice",callback,once);this._driver.delegate("stop_voice",data);if(this._params&&this._params.setTimeout_start_voice&&typeof(this._params.setTimeout_start_voice)=="function"){clearTimeout(this._params.setTimeout_start_voice)}},get_video:function(callback,once,data){this._core.register("get_video",callback,once);this._driver.delegate("get_video",data)},show_scan_qr:function(callback,once,data){this._core.register("get_scan_qr",callback,once);this._driver.delegate("get_scan_qr",data)},search_beacons:function(callback,once,data){this._core.register("search_beacons",callback,once);this._driver.delegate("search_beacons",data)},file_upload:function(callback,once,data){this._core.register("file_upload",callback,once);this._driver.delegate("file_upload",data)},set_data:function(callback,once,data){this._core.register("set_data",callback,once);this._driver.delegate("set_data",data)},get_data:function(callback,once,data){this._core.register("get_data",callback,once);this._driver.delegate("get_data",data)},set_share:function(callback,once,data){this._core.register("set_share",callback,once);this._driver.delegate("set_share",data)},auth_validate:function(options){},play_voice:function(callback,once,options){if(!options["address"]){return false}var ele_id="";if(options["ele_id"]){ele_id=options["ele_id"]}if(this._driver.driver_params&&this._driver.driver_params.client_code=="wx"){this._core.register("play_voice",callback,once);this._driver.delegate("play_voice",options);return}if(!typeof(options.address)=="string"||!/^(http|https):\/\/$/gi.test(options.address)){return}if(!options["ele_id"]){ele_id=this.tools.createAudioElement()}var audio=document.getElementById(ele_id);audio.src=options["address"];audio.play();if(options["on_play_end"]!=undefined){var is_playFinish=setInterval(function(){if(audio.ended){options["on_play_end"]({"ele_id":ele_id});window.clearInterval(is_playFinish)}},10)}return ele_id},pause_play_voice:function(callback,once,options){if(this._driver.driver_params&&this._driver.driver_params.client_code=="wx"){this._core.register("pause_play_voice",callback,once);this._driver.delegate("pause_play_voice",options);return}var audio=document.getElementById(options["ele_id"]);audio.pause();if(options["remove"]){audio.parentNode.removeChild(audio)}},stop_play_voice:function(callback,once,options){if(this._driver.driver_params&&this._driver.driver_params.client_code=="wx"){this._core.register("pause_play_voice",callback,once);this._driver.delegate("pause_play_voice",options);return}if(options.ele_id){var audio=document.getElementById(options["ele_id"]);audio.pause();audio.src="";if(options["remove"]){audio.parentNode.removeChild(audio)}callback()}},close_page:function(callback,once,options){this._driver.delegate("close",options)},url_redirect:function(options){this._driver.delegate("url_redirect",options)},bindmobile:function(callback,once,options){this._core.register("bindmobile",callback,once);this._driver.delegate("bindmobile",options)},is_bindmobile:function(callback,once,options){this._core.register("is_bindmobile",callback,once);this._driver.delegate("is_bindmobile",options)}};initcallback(apis)}catch(e){}};return CallService(initcallback)});